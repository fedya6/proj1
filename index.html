<!doctype html>
<html>
    <head>
        <title>Crafty</title>
        <link rel="stylesheet" href="./style.css">
        <link href='http://fonts.googleapis.com/css?family=Raleway:200,400,600' rel='stylesheet' type='text/css' data-noprefix>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:200,400,800' rel='stylesheet' type='text/css' data-noprefix>
        <script src="prefixfree.min.js" type="text/javascript"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="jquery-ui.min.js"></script>
    </head>
    <body>
        <div id="titles">
            <div class="slide">
                <div class="title">
                    <h1>Duis eros purus, vehicula vel massa quis, eleifend porta turpis.</h1>
                    <p>Etiam faucibus eget nulla at ultrices. Pellentesque vel dictum ligula. Quisque porta risus ut faucibus hendrerit. Integer facilisis nunc quis metus rhoncus, vel vulputate eros euismod.</p>
                </div>
                <button class="learnmore">Learn more</button>
            </div>
            <div class="slide">
                <div class="title">
                    <h1>Lorem ipsum dolor sit amet con&shy;sectetur adipiscing elitiam</h1>
                    <p>Etiam non nunc fermentum ante iaculis ultricies. Aenean posuere tincidunt elit, et egestas leo semper ut. Etiam tin&shy;ci&shy;dunt, ligula ac sollicitudin placerat, dolor nulla ultrices magna, eget tristique diam tellus sit amet erat.</p>
                </div>
                <button class="learnmore">Learn more</button>
            </div>
            <div class="slide">
                <div class="title">
                    <h1>Aliquam libero ex, dictum quis odio at, venenatis tempor tellus.</h1>
                    <p>Phasellus pellentesque turpis at elementum volutpat. Donec auctor efficitur eros, eget efficitur neque laoreet eu. Phasellus ornare libero sed lorem dictum, id vehicula metus vulputate. Nullam id maximus lorem.</p>
                </div>
                <button class="learnmore">Learn more</button>
            </div>
        </div>
        <div class="bg1">
            <div class="bg2">
                <div class="bg3">
                    <div class="changing-background">
                        <div class="img1">
                            <div class="frag1"></div>
                            <div class="frag2"></div>
                            <div class="frag3"></div>
                            <div class="frag4"></div>
                            <div class="frag5"></div>
                            <div class="frag6"></div>
                            <div class="frag7"></div>
                            <div class="frag8"></div>
                            <div class="frag9"></div>
                            <div class="frag10"></div>
                        </div> 
                        <div class="img2 active paused">
                            <div class="frag1"></div>
                            <div class="frag2"></div>
                            <div class="frag3"></div>
                            <div class="frag4"></div>
                            <div class="frag5"></div>
                            <div class="frag6"></div>
                            <div class="frag7"></div>
                            <div class="frag8"></div>
                            <div class="frag9"></div>
                            <div class="frag10"></div>
                        </div>
                        <div class="img3">
                            <div class="frag1"></div>
                            <div class="frag2"></div>
                            <div class="frag3"></div>
                            <div class="frag4"></div>
                            <div class="frag5"></div>
                            <div class="frag6"></div>
                            <div class="frag7"></div>
                            <div class="frag8"></div>
                            <div class="frag9"></div>
                            <div class="frag10"></div>
                        </div>    
                    </div>
                    <div class="slider">
                        <a href="#"><img src="images/Logo.png" alt="Logo" class="logo"></a>
                        <div class="animated-menu">
                            <ul class="menu-hover">
                                <li><a href="#">Home</a></li>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Work</a></li>
                                <li><a href="#">Services</a></li>
                                <li><a href="#">Team</a></li>
                                <li><a href="#">Contact</a></li>
                                <li><a href="#">Blog</a></li>
                            </ul>
                            <div class="menu">
                                <div class="lines">
                                    <div class="hline"></div>
                                    <div class="hline"></div>
                                    <div class="hline"></div>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                        <ul class="carousel">
                            <li></li>
                            <li class="active"></li>
                            <li></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="about-us">
            <header>
                <img src="images/iMac.png" alt="iMac">
                <div class="imac-bg"></div>
                <h1>We' re crafty</h1>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum.</p>
            </header>
            <div class="why-best">
                <div class="leftcol">
                    <div class="reason active r1">
                        <a>
                            <img src="images/light45.png" alt="light">
                        </a>
                        <div class="reason-desc">
                            <a>we're creative</a>
                            <span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam.</span>
                        </div>
                    </div>
                    <div class="reason r2">
                        <a>
                            <img src="images/ambulance8.png" alt="ambulance">
                        </a>
                        <div class="reason-desc">
                            <a>deliver on time</a>
                            <span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam.</span>
                        </div>
                    </div>
                </div>
                <div class="rightcol">
                    <div class="reason r3">
                        <a>
                            <img src="images/open95.png" alt="open">
                        </a>
                        <div class="reason-desc">
                            <a>we work hard</a>
                            <span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam.</span>
                        </div>
                    </div>
                    <div class="reason r4">
                        <a>
                            <img src="images/user78.png" alt="user">
                        </a>
                        <div class="reason-desc">
                            <a>unlimited support</a>
                            <span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam.</span>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <div class="works">
            <div class="bg4">
                <div class="bg5">
                    <div class="heart active"></div>
                    <ul class="reasons">
                        <li class="active r1">
                            <h1>we' re creative</h1>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum. </p>
                        </li>
                        <li class="r2">
                            <h1>deliver on time</h1>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum. </p>
                        </li>
                        <li class="r3">
                            <h1>we work hard</h1>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum. </p>
                        </li>
                        <li class="r4">
                            <h1>unlimited support</h1>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum. </p>
                        </li>
                    </ul>
                </div>
            </div>
            <ul class="filter">
                <div class="filter-border pos0"></div>
                <li>All</li>
                <li>Branding</li>
                <li>Web</li>
                <li>Photography</li>
                <li>Ui/ux</li>
                <li>Development</li>
            </ul>
            <div class="slides-box">
                <div class="slides-l wide long">
                    <div class="slides-lt slide narrow longest" style="background:url(images/forest.jpg);background-size:100% 100%;">
                        <div>
                            <h1>Project title</h1>
                            <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                        </div>
                    </div>
                    <div class="slides-lb narrow longest">
                        <div class="slides-lbl slide wide long" style="background:url(images/piter1.jpg);background-size:100% 100%;">
                            <div>
                                <h1>Project title</h1>
                                <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                            </div>
                        </div>
                        <div class="slides-lbr slide wide long" style="background:url(images/piter2.jpg);background-size:100% 100%;">
                            <div>
                                <h1>Project title</h1>
                                <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slides-c wide short">
                    <div class="slides-ct slide narrow longest" style="background:url(images/piter3.jpg);background-size:100% 100%;">
                        <div>
                            <h1>Project title</h1>
                            <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                        </div>
                    </div>
                    <div class="slides-cb slide narrow longest" style="background:url(images/mountain.jpg);background-size:100% 100%;">
                        <div>
                            <h1>Project title</h1>
                            <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                        </div>
                    </div>
                </div>
                <div class="slides-r slide short wide" style="background:url(images/tadj.jpg);background-size:100% 100%;">
                    <div>
                        <h1>Project title</h1>
                        <p>Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,</p>
                    </div>
                </div>
            </div>
            <div class="bg6"></div>
        </div>
        <div class="contact">
            <img id="rocket" src="images/rocket.png">
            <header>
                <h1>get in touch</h1>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas diam sapien, auctor sed blandit nec, adipiscing eget elit. Duis tempor elementum quam consequat condimentum. </p>
            </header>
            <div class="bg7"></div>
            <div class="bg8"></div>
            <form>
                <input type="text" name="name" id="name" placeholder="your name">
                <input type="email" name="email" id="email" placeholder="your email">
                <input type="text" name="subject" id="subject" placeholder="subject">
                <textarea name="message">your message text</textarea>
                <input type="submit" value="click to send">
            </form>
        </div>
        <footer>
            
        </footer>
        <script>
                var slidesSrcByCategory = [
                    [
                        {
                            'src':'forest.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'piter1.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'piter2.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'piter3.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'mountain.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'tadj.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ],
                    [
                        {
                            'src':'forest.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'mountain.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'bajkal.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'sky.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'waterfall.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'underground.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ],
                    [
                        {
                            'src':'piter1.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,',
                        },
                        {
                            'src':'piter2.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'piter3.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'la1.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'la2.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'la3.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ],
                    [
                        {
                            'src':'cat1.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'cat2.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'cat3.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'cat4.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'cat5.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'cat6.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ],
                    [
                        {
                            'src':'dog1.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'dog2.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'dog3.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'dog4.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'dog5.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'dog6.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ],
                    [
                        {
                            'src':'tadj.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'piramides.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {  
                            'src':'lighthouse.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'pisan.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'eifel.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        },
                        {
                            'src':'kremlin.jpg',
                            'title':'Project Title',
                            'text':'Lorem ipsum dolor sit amet, con&shy;sectetur adipiscing elit. Maecenas diam sapien,'
                        }
                    ]
                ]
                
                function moveOldSlides(){
                    var oldSlides = $(".slides-box:not(.btm-layer)");
                    var dirs = []; //направления сдвига старых слайдов
                    for (var i=0;i<6;++i){
                        dirs.push(Math.floor(Math.random()*2)); //0-T, 1-L
                    }
                    var dir;
                    oldSlides.find('.slide').each(function(num,elem){
                        switch (dirs[num]){
                            case 0:
                                dir = "up";
                                break;
                            case 1:
                                dir = "left";
                                break;
                        }
                        $(elem).hide("blind",{direction:dir},1000,function(){
                            oldSlides.remove();
                            $(".slides-box").removeClass("btm-layer");
                        });
                    });
                }
                
                function changeSlides(category){
                    var slides = slidesSrcByCategory[category];
                    var longSlideNum = Math.floor(Math.random()*6);
                    var wideSlideNum;
                    do {
                        wideSlideNum = Math.floor(Math.random()*6);
                    } while (wideSlideNum == longSlideNum);
                    var longSlidePos = Math.floor(Math.random()*6); //0 - TL, 1 - TC, 2 - TR, 3 - BL, 4 - BC, 5 - BR;
                    var wideSlidePos = Math.floor(Math.random()*2); //0 - L, 1 - R;
                    var wideSlideRealPos;
                    if (wideSlidePos == 0) {
                        if (longSlidePos == 0 || longSlidePos == 3) {
                            wideSlideRealPos = 1; //center
                        } else {
                            wideSlideRealPos = 0; //left
                        }
                    } else if (wideSlidePos == 1) {
                        if (longSlidePos ==2 || longSlidePos == 5) {
                            wideSlideRealPos = 1; //center
                        } else {
                            wideSlideRealPos = 2; //right
                        }
                    }
                    var slidesStruct = {"type":"div","cls":"slides-box btm-layer","content":"","src":"","childs":[]};
                    
                    var leftBlockCls = "slides-l wide";
                    var centerBlockCls = "slides-c wide";
                    var rightBlockCls = "slides-r wide";
                    //var wideSlideSrc = "";
                    
                    if (wideSlideRealPos == 0) { //широкий блок слева
                        leftBlockCls += " slide";
                    } else if (wideSlideRealPos == 1) { //посередине
                        centerBlockCls += " slide";
                    } else if (wideSlideRealPos == 2) { // справа
                        rightBlockCls += " slide";
                    }
                    
                    if (longSlidePos == 0 || longSlidePos == 3){
                        leftBlockCls += " long";
                        centerBlockCls += " short";
                        rightBlockCls += " short";
                    } else if (longSlidePos == 1 || longSlidePos == 4){
                        leftBlockCls += " short";
                        centerBlockCls += " long";
                        rightBlockCls += " short";
                    } else if (longSlidePos == 2 || longSlidePos == 5){
                        leftBlockCls += " short";
                        centerBlockCls += " short";
                        rightBlockCls += " long";
                    }
                    
                    slidesStruct.childs.push({"type":"div","cls":leftBlockCls,"content":"","src":"","childs":[]});
                    var leftSubBlocks = slidesStruct.childs[0];
                    slidesStruct.childs.push({"type":"div","cls":centerBlockCls,"content":"","src":"","childs":[]});
                    var centerSubBlocks = slidesStruct.childs[1];
                    slidesStruct.childs.push({"type":"div","cls":rightBlockCls,"content":"","src":"","childs":[]});
                    var rightSubBlocks = slidesStruct.childs[2];
                    
                    var slidesPointer = 0;
                    for (var i=0;i<3;++i){
                        computeBlock(i);
                    }
                    slidesPointer = 0;
                    
                    $(".slides-box").after("<"+slidesStruct.type + " class=\"" + slidesStruct.cls + "\"></" + slidesStruct.type + ">");
                    buildTree(slidesStruct);
                    
                    function buildTree(struct) {
                        var clsStr = "." + struct.cls.split(" ").reduce(function(a,b){
                            return a+"."+b;
                        });
                        if (clsStr.indexOf(".btm-layer")==-1){
                            clsStr = ".btm-layer ".concat(clsStr);
                        }
                        if (/\bslide\b/.test(struct.cls)){
                            $(clsStr).css('background-image','url(images/'+struct.src+')');
                        }
                        if (struct.childs.length == 0) {
                            return;
                        } else {
                            struct.childs.forEach(function(elem){
                                $(clsStr).append("<" + elem.type + " class=\"" + elem.cls + "\">" + elem.content + "</" + elem.type + ">");
                                buildTree(elem);
                            });
                        }
                    }
                    
                    function addContentToSlide(title,content,position){
                        console.log(position.cls);
                        var slidePos = /slides-([ltcrb]+)/.exec(position.cls);
                        position.childs.push({"type":"div","cls":"slide-" + slidePos[1] + "-content","content":"","src":"","childs":[
                            {"type":"h1","cls":"content-title","content":title,"src":"",childs:[]},
                            {"type":"p","cls":"content-text","content":content,"src":"",childs:[]}
                        ]});
                    }
                    
                    function computeBlock(position){ //position: 0-L, 1-C, 2-R
                        var subBlocks;
                        var posSymbol;
                        switch(position){
                            case 0:
                                subBlocks = leftSubBlocks;
                                posSymbol = "l";
                                break;
                            case 1:
                                subBlocks = centerSubBlocks;
                                posSymbol = "c";
                                break;
                            case 2:
                                subBlocks = rightSubBlocks;
                                posSymbol = "r";
                                break;
                        }
                        if (wideSlideRealPos != position){
                            if (longSlidePos == position) {
                                subBlocks.childs.push({"type":"div",
                                                       "cls":"slides-"+posSymbol+"t slide longest narrow",
                                                       "content":"",
                                                       "src":slides[slidesPointer].src,
                                                       "childs":[]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[0]
                                );
                                subBlocks.childs.push({"type":"div",
                                                       "cls":"slides-"+posSymbol+"b longest narrow",
                                                       "content":"",
                                                       "src":"",
                                                       "childs":[{
                                                            "type":"div",
                                                            "cls":"slides-"+posSymbol+"bl slide long wide",
                                                            "content":"",
                                                            "src":slides[slidesPointer].src,
                                                            "childs":[]}
                                ]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[1].childs[0]
                                );
                                subBlocks.childs[1].childs.push(
                                    {"type":"div",
                                     "cls":"slides-"+posSymbol+"br slide long wide",
                                     "content":"",
                                     "src":slides[slidesPointer].src,
                                     "childs":[]}
                                );
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[1].childs[1]
                                );
                            } else if (longSlidePos == position+3) {
                                subBlocks.childs.push({"type":"div","cls":"slides-"+posSymbol+"t longest narrow","content":"","childs":[
                                    {"type":"div",
                                     "cls":"slides-"+posSymbol+"tl slide long wide",
                                     "content":"",
                                     "src":slides[slidesPointer].src,
                                     "childs":[]}
                                ]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[0].childs[0]
                                );
                                subBlocks.childs[0].childs.push(
                                    {"type":"div",
                                     "cls":"slides-"+posSymbol+"tr slide long wide",
                                     "content":"",
                                     "src":slides[slidesPointer].src,
                                     "childs":[]}
                                );
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[0].childs[1]
                                );
                                subBlocks.childs.push({"type":"div",
                                                       "cls":"slides-"+posSymbol+"b slide longest narrow",
                                                       "content":"",
                                                       "src":slides[slidesPointer].src,
                                                       "childs":[]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[1]
                                );
                            } else {
                                subBlocks.childs.push({"type":"div",
                                                       "cls":"slides-"+posSymbol+"t slide longest narrow",
                                                       "content":"",
                                                       "src":slides[slidesPointer].src,
                                                       "childs":[]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[0]
                                );
                                subBlocks.childs.push({"type":"div",
                                                       "cls":"slides-"+posSymbol+"b slide longest narrow",
                                                       "content":"",
                                                       "src":slides[slidesPointer].src,
                                                       "childs":[]});
                                addContentToSlide(
                                    slides[slidesPointer].title,
                                    slides[slidesPointer++].text,
                                    subBlocks.childs[1]
                                );
                            }
                        } else {
                            subBlocks.src += slides[slidesPointer].src;
                            addContentToSlide(slides[slidesPointer].title,slides[slidesPointer++].text,subBlocks);
                        }
                    }
                }
            
                window.onload = function(){
                    $("ul.filter li").each(function(i,elem){
                        var width = $(elem).outerWidth();
                        var pos = $(elem).position();
                        $(elem).attr("data-width",width-1).attr("data-pos",pos.left);
                    });
                    
                    $("ul.filter li").on("click",function(){
                        for (var i=0;i<6;++i) {
                            $(".filter-border").removeClass("pos"+i);
                        }
                        var pos = $(this).index("ul.filter li");
                        $(".filter-border").addClass("pos"+pos);
                        var selLi = "ul.filter li:nth-of-type(" + (pos+1) + ")";
                        var leftBias = Number($(selLi).attr("data-pos"));
                        $(".filter-border").css({'left':leftBias+'px','width':$(selLi).attr("data-width")+'px'});
                        changeSlides(pos);
                        moveOldSlides();
                    });
                }
                
                $(document).ready(function(){
                    var currentPos = 1;
                    var slides = $("div#titles .slide");
                    var slidesNum = slides.length;
                    slides.wrapAll('<div id="slideInner"></div>').css({'float':'left','width':100/slidesNum+'%'});
                    $("#slideInner").css({'width':slidesNum*100+'%','marginLeft':'-100%'});
                    $(".carousel li").click(function(){
                        if ($(this).hasClass('active')){
                            return;
                        }
                        currentPos = $(this).index();
                        console.log("pos="+currentPos);
                        $("#slideInner").animate({
                            'marginLeft':(currentPos-2)*100+'%'
                        },2000,'easeInOutCubic');
                        $(".carousel li.active").toggleClass('active');
                        $(this).toggleClass('active');
                        $(".changing-background > div.active").toggleClass('active');
                        $(".img"+(currentPos+1)).toggleClass('active');
                        titleActivate(currentPos+1);
                        reloadAnimation($(this));
                        runningState();
                    });
                });

                $(".animated-menu").on('click',function(){
                    if ($(this).hasClass('animate-back')){
                        $(this).removeClass('animate-back').addClass('animate');
                    } else if ($(this).hasClass('animate')){
                        $(this).removeClass('animate').addClass('animate-back');
                    } else {
                        $(this).addClass('animate');
                    }
                    var elem = $(this);
                    var newelem = elem.clone(true);
                    elem.before(newelem);
                    $(".animated-menu:last").remove();
                });

                function reloadAnimation(elem){
                    var newelem = elem.clone(true);
                    elem.before(newelem);
                    elem.remove();
                }

                function runningState() {
                    if ($(".changing-background div[class^='img'].active").hasClass("paused")) {
                        $(".changing-background div[class^='img'].active").removeClass("paused").addClass("running");
                    }
                    if ($("#titles li.title-active").hasClass("paused")) {
                        $("#titles li.title-active").removeClass("paused").addClass("running");
                    }
                }

                function titleActivate(num) {
                    $("#titles li.title-to-hide").toggleClass('title-to-hide');
                    $("#titles li.title-active").toggleClass('title-active').toggleClass('title-to-hide');
                    $("#titles li:nth-child("+num+")").toggleClass('title-active');
                }

                function changeClass(curobj,newobj,clname) {
                    $(curobj).removeClass(clname);
                    $(newobj).addClass(clname);
                }

                $(".why-best .reason").on('click',function(){
                    if ($(this).hasClass('active') || $('.bg4').hasClass('animate')){
                        return;
                    }
                    $(".why-best .reason.active").toggleClass('active');
                    $(this).toggleClass('active');
                    if ($(this).hasClass("r1")) {
                        setTimeout("changeClass('.works .reasons li.active','.works li.r1','active');$('.heart').toggleClass('active');",700);
                    } else if ($(this).hasClass("r2")) {
                        setTimeout("changeClass('.works .reasons li.active','.works li.r2','active');$('.heart').toggleClass('active');",700);
                    } if ($(this).hasClass("r3")) {
                        setTimeout("changeClass('.works .reasons li.active','.works li.r3','active');$('.heart').toggleClass('active');",700);
                    } if ($(this).hasClass("r4")) {
                        setTimeout("changeClass('.works .reasons li.active','.works li.r4','active');$('.heart').toggleClass('active');",700);
                    }
                    $(".bg4").toggleClass('animate');
                    setTimeout("$('.bg4').toggleClass('animate');$('.heart').toggleClass('active')",2000);
                });
        </script>
    </body>
</html>
